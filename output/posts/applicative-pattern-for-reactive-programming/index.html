<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Applicative pattern for reactive programming | Adam Saleh's notes</title>
<link href="../../assets/css/theme.css" type="text/css" rel="stylesheet">
<link href="../../assets/css/pure.css" type="text/css" rel="stylesheet">
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://notes.asaleh.net/posts/applicative-pattern-for-reactive-programming/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Adam Saleh">
<link rel="prev" href="../monoid-for-specifying-configuration/" title="Monoid for specifying configuration" type="text/html">
<link rel="next" href="../debugging-jenkins-pipeline/" title="Debugging Jenkins pipeline" type="text/html">
<meta property="og:site_name" content="Adam Saleh's notes">
<meta property="og:title" content="Applicative pattern for reactive programming">
<meta property="og:url" content="http://notes.asaleh.net/posts/applicative-pattern-for-reactive-programming/">
<meta property="og:description" content="Reactive programming with applicatives!¶One interesting thing we could do with applicatives, is to experiment with gui programming. I have been playing around with excelent flare library in purescript">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-06-11T19:22:05+02:00">
<meta property="article:tag" content="algebraic-patterns">
</head>
<body>
<div class="body_container">
    <div id="header">
        <div class="site-name">
                <a id="logo" href="http://notes.asaleh.net/"><h1>Adam Saleh's notes</h1></a>
        </div>

        <div id="nav-menu">
            <div class="bitcron_nav_container">
                <div class="bitcron_nav">
                    <div class="site_nav_wrap">
                        <ul class="site_nav sm sm-base">
<li><a href="../../pages/about/" class="nav__item">About</a></li>
            <li><a href="../../pages/algebraic-patterns/" class="nav__item">Algebraic patterns</a></li>
            <li><a href="../../archive.html" class="nav__item">Archive</a></li>
            <li><a href="../../categories/" class="nav__item">Tags</a></li>
            <li><a href="../../rss.xml" class="nav__item">RSS feed</a></li>

                            
                        </ul>
<div class="clear clear_nav_inline_end"></div>
                    </div>
                </div>
                <div class="clear clear_nav_end"></div>
            </div>
        </div>
    </div>
    <div id="layout">
        <div class="pure-g">
            <div class=" pure-u-24-24 pure-u-sm-24-24 pure-u-md-18-24 pure_cell">
                <div class="content_container">
                    <!--Body content-->
                    <div class="row">
                        
                        
<div class="post post-page">
    
    <header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Applicative pattern for reactive programming</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Adam Saleh
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2017-06-11T19:22:05+02:00" itemprop="datePublished" title="2017-06-11 19:22">2017-06-11 19:22</time></a></p>
                <p class="commentline">
        
<a href="%7Blink%7D" onclick="this.href='/posts/applicative-pattern-for-reactive-programming/'; this.target='_self';"><span class="IDCommentsReplace" style="display:none">cache/posts/applicative-pattern-for-reactive-programming.html</span>
<script>
var idcomments_acct = '1fb78414f6b8ffc05cf0238b6fa4e491';
var idcomments_post_id = "cache/posts/applicative-pattern-for-reactive-programming.html";
var idcomments_post_url = "/posts/applicative-pattern-for-reactive-programming/";
</script><script src="http://www.intensedebate.com/js/genericLinkWrapperV2.js"></script></a>


            
        </p>
<p class="sourceline"><a href="index.ipynb" id="sourcelink">Source</a></p>

        </div>
        

    </header><div class="post-content">
        <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reactive-programming-with-applicatives!">Reactive programming with applicatives!<a class="anchor-link" href="#Reactive-programming-with-applicatives!">¶</a>
</h2>
<p>One interesting thing we could do with applicatives, is to experiment with gui programming. I have been playing around with excelent <a href="http://try.purescript.org/?backend=flare&amp;session=73d51f0a-28f2-a0d1-638e-4793f705c1e8">flare library</a> in purescript and it heavily uses applicative style to achieve a style of code that is resembling working with spreadsheets.</p>
<!-- TEASER_END -->

<p>In ipython, we have access to ipywidgets, that can be used to create simple forms.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">display</span>
<span class="n">slider</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">()</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="s2">"0"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">slider</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>




 
 
<div id="8f06fa75-37ef-49f4-9c3f-e1f98533f162"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#8f06fa75-37ef-49f4-9c3f-e1f98533f162');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c772c4398f5446f2b0b48eae71a1eeab"}
</script>
</div>

</div>

<div class="output_area">
<div class="prompt"></div>




 
 
<div id="93f4b047-63cd-4ccf-aad8-99a9560e3ef0"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#93f4b047-63cd-4ccf-aad8-99a9560e3ef0');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6c512d8bcb4c495887ed83c25bb7bf90"}
</script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we can listen on changes and set values of these forms-objects.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">updateLabel</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="n">label</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">slider</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            
<span class="n">slider</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">updateLabel</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, lets we want to have two sliders and display the sum.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">display</span>
<span class="n">sliderA</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">()</span>
<span class="n">sliderB</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">()</span>
<span class="n">labelSum</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="s2">"0"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sliderA</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sliderB</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">labelSum</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">updateSum</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="n">labelSum</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sliderA</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">sliderB</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    
<span class="n">sliderA</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">updateSum</span><span class="p">)</span>
<span class="n">sliderB</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">updateSum</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>




 
 
<div id="503c9b69-96e1-4538-ac7c-61524067ca1c"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#503c9b69-96e1-4538-ac7c-61524067ca1c');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "2e3158be6f2f41d68ee30c5164d293d8"}
</script>
</div>

</div>

<div class="output_area">
<div class="prompt"></div>




 
 
<div id="7f2ba935-5483-4e9b-b341-9f5d365dd3ad"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#7f2ba935-5483-4e9b-b341-9f5d365dd3ad');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "aeb98557ab404309a70812cb90e1bdc4"}
</script>
</div>

</div>

<div class="output_area">
<div class="prompt"></div>




 
 
<div id="b246e469-aa3a-4615-a02b-b7af54a73788"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#b246e469-aa3a-4615-a02b-b7af54a73788');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0c883e3d7a094975a948a810c2ca770b"}
</script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I dislike two things about this:</p>
<ul>
<li>the objects are hardcoded in the update function</li>
<li>I need to wire the observables by hand</li>
</ul>
<p>You could solve this in many diferent ways, but one that I would preffer looks like this:</p>

<pre><code>@lift
def sum(a,b):
  return str(a + b)

labelSum.subscribesTo(sum(sliderA,sliderB))</code></pre>
<p>First, lets bring back the Applicative class and the accompanying machinery, we will need</p>
<ul>
<li>curry</li>
<li>apply</li>
<li>lift</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>

<span class="k">def</span> <span class="nf">curry</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">partial</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">curry</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">partial</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">Applicative</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">pure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span>
    
    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">();</span>
        
    <span class="k">def</span> <span class="nf">lift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">lifted</span><span class="p">(</span><span class="n">arg0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pure</span><span class="p">(</span><span class="n">curry</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">fn</span><span class="p">)),</span><span class="n">arg0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">lifted</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I will create a simple applicative, reactive object, that  I would call Propagated.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Propagated</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">last</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last</span> <span class="o">=</span> <span class="n">last</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subscriptions</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">last</span>
    
    <span class="k">def</span> <span class="nf">subscribesTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cb</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subscriptions</span> <span class="o">+=</span><span class="p">[</span><span class="n">cb</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">observe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="n">prop</span><span class="o">.</span><span class="n">subscribesTo</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">setValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subscriptions</span><span class="p">:</span>
            <span class="n">cb</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I can create the Applicative instance.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ApplyPropagated</span><span class="p">(</span><span class="n">Applicative</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">pure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Propagated</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Propagated</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">getValue</span><span class="p">()(</span><span class="n">val</span><span class="o">.</span><span class="n">getValue</span><span class="p">()))</span>
        <span class="n">fn</span><span class="o">.</span><span class="n">subscribesTo</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">getValue</span><span class="p">())))</span>
        <span class="n">val</span><span class="o">.</span><span class="n">subscribesTo</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">getValue</span><span class="p">()(</span><span class="n">v</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">result</span>
    
<span class="n">applyPropagated</span> <span class="o">=</span> <span class="n">ApplyPropagated</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I create two wrappers for converting the ipywidgets to faucets and sinks.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">propagatedWidgetFaucet</span><span class="p">(</span><span class="n">widget</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
    <span class="n">propagated</span> <span class="o">=</span> <span class="n">Propagated</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'value'</span><span class="p">:</span>
            <span class="n">propagated</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">'new'</span><span class="p">])</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">propagated</span>

<span class="k">def</span> <span class="nf">propagatedWidgetSink</span><span class="p">(</span><span class="n">widget</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Propagated</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setVal</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>        
    <span class="n">p</span><span class="o">.</span><span class="n">subscribesTo</span><span class="p">(</span><span class="n">setVal</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And with these, we can easily define the data-flow of our form.</p>
<ul>
<li>A and B are the inputs</li>
<li>
<code>sump</code> is just a normal function, that does what we need</li>
<li>SUM is the output</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">propagatedWidgetFaucet</span><span class="p">(</span><span class="n">IntSlider</span><span class="p">())</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">propagatedWidgetFaucet</span><span class="p">(</span><span class="n">IntSlider</span><span class="p">())</span>
<span class="n">SUM</span> <span class="o">=</span> <span class="n">propagatedWidgetSink</span><span class="p">(</span><span class="n">Label</span><span class="p">(</span><span class="s2">"0"</span><span class="p">))</span>

<span class="nd">@applyPropagated</span><span class="o">.</span><span class="n">lift</span>
<span class="k">def</span> <span class="nf">sump</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

<span class="n">SUM</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">sump</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>




 
 
<div id="545fcc97-9af4-4097-853b-a2e12842c01f"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#545fcc97-9af4-4097-853b-a2e12842c01f');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "7705f0f0dfe24bd9a7530f28d0378ab3"}
</script>
</div>

</div>

<div class="output_area">
<div class="prompt"></div>




 
 
<div id="3a6e7b39-7b4c-416d-b67b-b4943096f8a7"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#3a6e7b39-7b4c-416d-b67b-b4943096f8a7');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "2f7b4fc738fc437f9391b36f0e35cf63"}
</script>
</div>

</div>

<div class="output_area">
<div class="prompt"></div>




 
 
<div id="850f2467-8828-4fc3-902f-a2ea028ff8fe"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#850f2467-8828-4fc3-902f-a2ea028ff8fe');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1021e85917994526be792a437040083c"}
</script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What if we want to add another slider, with one more veriable?
That is not a problem. We could even factor out <code>str</code> out of our <code>sump</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">propagatedWidgetFaucet</span><span class="p">(</span><span class="n">IntSlider</span><span class="p">())</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">propagatedWidgetFaucet</span><span class="p">(</span><span class="n">IntSlider</span><span class="p">())</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">propagatedWidgetFaucet</span><span class="p">(</span><span class="n">IntSlider</span><span class="p">())</span>
<span class="n">SUM</span> <span class="o">=</span> <span class="n">propagatedWidgetSink</span><span class="p">(</span><span class="n">Label</span><span class="p">(</span><span class="s2">"0"</span><span class="p">))</span>

<span class="nd">@applyPropagated</span><span class="o">.</span><span class="n">lift</span>
<span class="k">def</span> <span class="nf">strp</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="nd">@applyPropagated</span><span class="o">.</span><span class="n">lift</span>
<span class="k">def</span> <span class="nf">sump</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>


<span class="n">SUM</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">strp</span><span class="p">(</span><span class="n">sump</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>




 
 
<div id="c046cf48-b66b-438b-8361-5e9b3211e297"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#c046cf48-b66b-438b-8361-5e9b3211e297');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1b682292c5814951a0fdcdd0b032d105"}
</script>
</div>

</div>

<div class="output_area">
<div class="prompt"></div>




 
 
<div id="beaf7380-d5b0-47dc-b591-735353528912"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#beaf7380-d5b0-47dc-b591-735353528912');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8e462b4de73b415db65d4d5f876ee0b9"}
</script>
</div>

</div>

<div class="output_area">
<div class="prompt"></div>




 
 
<div id="b8960e0e-4632-4d25-a5ba-144762082f2a"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#b8960e0e-4632-4d25-a5ba-144762082f2a');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d13a3f1f7b154c1fa3df742c4707be0b"}
</script>
</div>

</div>

<div class="output_area">
<div class="prompt"></div>




 
 
<div id="2562f91b-0ae3-4223-a9d5-2d8b2493ec2c"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#2562f91b-0ae3-4223-a9d5-2d8b2493ec2c');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9130c25210a14674b31c8725eb9bcff5"}
</script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we want to process the values differently, we just have to:</p>
<ul>
<li>create a new WidgetSink</li>
<li>create a different function to process the values</li>
<li>combine it with any previously defined functions:</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">AVG</span> <span class="o">=</span> <span class="n">propagatedWidgetSink</span><span class="p">(</span><span class="n">Label</span><span class="p">(</span><span class="s2">"0"</span><span class="p">))</span>
<span class="nd">@applyPropagated</span><span class="o">.</span><span class="n">lift</span>
<span class="k">def</span> <span class="nf">awgp</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">AVG</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">strp</span><span class="p">(</span><span class="n">awgp</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>




 
 
<div id="d9bba2d2-677a-4ea7-98ea-0fdb03bfda11"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#d9bba2d2-677a-4ea7-98ea-0fdb03bfda11');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a1dbac08557f4c78a831e2c262fe51a9"}
</script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And this, in my mind showcases the elegance of applicatives.</p>
<ul>
<li>We have object that has fairly complex api, i.e. our <code>Propagated</code>.</li>
<li>Conceptually, we know that the object just wraps some value.</li>
</ul>
<p>Because we have implemented applicative, if user of our Propagated wants to combine these values</p>
<ul>
<li>they just create a function that know how to combine the <em>values</em> and nothing about how they are <em>encapsulated</em>
</li>
<li>then they lift the function and use it on wrapped values :-)</li>
</ul>
</div>
</div>
</div>
    </div>
  </div>

    </div>
    <div class="postpromonav">
        <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/algebraic-patterns/" rel="tag">algebraic-patterns</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../monoid-for-specifying-configuration/" rel="prev" title="Monoid for specifying configuration">Previous post</a>
            </li>
            <li class="next">
                <a href="../debugging-jenkins-pipeline/" rel="next" title="Debugging Jenkins pipeline">Next post</a>
            </li>
        </ul></nav>
</div>
    <section class="comments hidden-print"><h2>Comments</h2>
        
        
<script>
var idcomments_acct = '1fb78414f6b8ffc05cf0238b6fa4e491';
var idcomments_post_id = "cache/posts/applicative-pattern-for-reactive-programming.html";
var idcomments_post_url = "http://notes.asaleh.net/posts/applicative-pattern-for-reactive-programming/";
</script><span id="IDCommentsPostTitle" style="display:none"></span>
<script src="http://www.intensedebate.com/js/genericCommentWrapperV2.js"></script></section><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><script type="text/x-mathjax-config">
            MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
            </script>
</div>

                </div>
                <!--End of body content-->
                <div style="clear:both;height:0;"></div>
            </div>
        </div>

        <!-- Sidebar -->

        <div class=" pure-u-6-24 pure_cell">
            <div id="sidebar">
                <div class="widget">
                    <div id="search_bar">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="footer">
        Contents © 2017         <a href="mailto:adam@">Adam Saleh</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
        
    </div>

    <!--FIXME: put these somewhere                            -->
    <!--%if len(translations) > 1:-->
    <!--<li>
</li>-->
    <!--%endif-->
    <!--% if show_sourcelink:-->
    <!---->
    <!--%endif-->
    <link href="../../assets/css/duoshuo.css" type="text/css" rel="stylesheet">
<script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</div>
</div>
</body>
</html>
